#!/usr/bin/env node

var extend = require('gextend');
var exec = require('child_process').exec,
    child;

var argv = process.argv.concat();
var cmd = argv.splice(2);
console.log('cmd', cmd);
console.log('args', argv.splice(2));
console.log('execPath', process.execPath.toString());

//We should load
function loadEnvironment(envName){
    return new Promise(function(resolve, reject){
        var environment = { NODE_ENV:'th', DEBUG:true, MSG:'HOLA MUNDO'};
        var _env = extend({}, process.env, environment);
        resolve(_env);
    });
}

var envName = 'dev';
loadEnvironment(envName).then(function(env){
    child = exec('node kk.js -a pepe -b pipo --verbose',
        {env:env},
      function (error, stdout, stderr) {
        console.log('stdout: ' + stdout);
        console.log('stderr: ' + stderr);
        if (error !== null) {
          console.log('exec error: ' + error);
        }
    });
});
